<ng-container id="external-calendar-popup" *transloco="let t">
  <div class="form-canvas">
    <biit-tab-group id="external-providers-tabs" [loading]="loadingCredentials">
      <biit-tab id="google" [name]="t('form.google')">
        <div class="row" *ngIf="googleCredentialsExists==undefined || !googleCredentialsExists">
          {{ t('form.introductionGoogle') }}
        </div>
        <div class="row" *ngIf="googleCredentialsExists!=undefined && googleCredentialsExists">
          {{ t('form.introductionGoogle-already-connected') }}
        </div>
        <div class="row-double" style="margin-top: 3rem">
          <button id="google-login-button" [disabled]="googleCredentialsExists || loadingCredentials" class="buttons"
                  biit-button primary
                  (click)="triggerOauthRequest(CalendarProvider.GOOGLE)">
            {{ t('form.connect') }}
          </button>
          <button id="google-disconnect-button" class="buttons"
                  [disabled]="(googleCredentialsExists!=undefined && !googleCredentialsExists) || loadingCredentials"
                  biit-button secondary
                  (click)="disconnectFromGoogle()">
            {{ t('form.disconnect') }}
          </button>
        </div>
      </biit-tab>
      <biit-tab id="microsoft" [name]="t('form.microsoft')">
        <div class="row" *ngIf="msCredentialsExists==undefined || !msCredentialsExists">
          {{ t('form.introductionMS') }}
        </div>
        <div class="row" *ngIf="msCredentialsExists!=undefined && msCredentialsExists">
          {{ t('form.introductionMS-already-connected') }}
        </div>
        <div class="row-double" style="margin-top: 3rem">
          <button id="ms-login-button" [disabled]="msCredentialsExists || loadingCredentials" class="buttons"
                  biit-button primary
                  (click)="triggerOauthRequest(CalendarProvider.MICROSOFT)">
            {{ t('form.connect') }}
          </button>
          <button id="ms-disconnect-button" class="buttons"
                  [disabled]="(msCredentialsExists!=undefined && !msCredentialsExists) || loadingCredentials"
                  biit-button
                  secondary
                  (click)="disconnectFromMS()">
            {{ t('form.disconnect') }}
          </button>
        </div>
      </biit-tab>
    </biit-tab-group>
  </div>
</ng-container>
